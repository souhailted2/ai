let tasks=JSON.parse(localStorage.getItem('tasks')||'[]'),filter='all';const list=document.getElementById('taskList'),input=document.getElementById('taskInput'),priority=document.getElementById('priority'),countEl=document.getElementById('taskCount');function render(){const filtered=filter==='all'?tasks:filter==='active'?tasks.filter(t=>!t.done):tasks.filter(t=>t.done);list.innerHTML=filtered.map((t,i)=>`<div class="task-item ${t.done?'done':''}" data-id="${t.id}"><div class="task-check ${t.done?'checked':''}" onclick="toggle('${t.id}')"></div><span class="task-text">${t.text}</span><span class="priority-dot ${t.priority}"></span><button class="task-delete" onclick="remove('${t.id}')">&times;</button></div>`).join('');const active=tasks.filter(t=>!t.done).length;countEl.textContent=`${active} task${active!==1?'s':''} remaining`;save()}function save(){localStorage.setItem('tasks',JSON.stringify(tasks))}function add(){const text=input.value.trim();if(!text)return;tasks.unshift({id:Date.now().toString(),text,priority:priority.value,done:false});input.value='';render()}function toggle(id){const t=tasks.find(t=>t.id===id);if(t)t.done=!t.done;render()}function remove(id){tasks=tasks.filter(t=>t.id!==id);render()}document.getElementById('addBtn').addEventListener('click',add);input.addEventListener('keydown',e=>{if(e.key==='Enter')add()});document.querySelectorAll('.filter').forEach(btn=>{btn.addEventListener('click',()=>{document.querySelectorAll('.filter').forEach(b=>b.classList.remove('active'));btn.classList.add('active');filter=btn.dataset.filter;render()})});document.getElementById('clearDone').addEventListener('click',()=>{tasks=tasks.filter(t=>!t.done);render()});render();